# 対面レビューのコツ

対面レビュー（コードレビュー）は、作成したコードや成果物を先輩・上司・チームメンバーに確認してもらう重要なプロセスです。

---

## 対面レビューとは

```
開発者が作成したコードや資料を、レビュアー（確認者）に説明し、
フィードバックをもらうことで品質を向上させるプロセス
```

### レビューの目的

| 目的 | 説明 |
|------|------|
| バグの早期発見 | 本番環境に出る前に問題を見つける |
| コード品質の向上 | より良い書き方を学ぶ |
| 知識の共有 | チーム内で技術や仕様を共有する |
| 設計の確認 | 要件通りに作られているか確認する |
| スキルアップ | フィードバックを通じて成長する |

---

## 対面レビューの流れ

### 全体の流れ

```
1. 事前準備（資料作成・動作確認）
        ↓
2. レビュー依頼（日時調整）
        ↓
3. 対面レビュー実施
        ↓
4. 指摘事項の記録
        ↓
5. 修正作業
        ↓
6. 再レビュー（必要に応じて）
        ↓
7. 完了
```

### 各フェーズの詳細

#### 1. 事前準備（最重要）

レビュー前に必ず行うこと：

```
□ コードが動作することを確認
□ 自分でテストを実施
□ エラーや警告がないことを確認
□ 説明資料を準備
□ デモの手順を確認
```

#### 2. レビュー依頼

```
例: Slackやメールでの依頼文

件名: 【レビュー依頼】ユーザー登録機能

○○さん

お疲れ様です。△△です。
ユーザー登録機能の実装が完了しましたので、
レビューをお願いできますでしょうか。

■ 対象機能: ユーザー登録（新規会員登録）
■ 対象ファイル:
  - UserDAO.java（registerメソッド追加）
  - RegisterServlet.java（新規作成）
  - register.jsp（新規作成）
■ 所要時間: 15〜20分程度
■ 希望日時: 本日15時以降、または明日午前中

ご都合の良い時間を教えていただけると助かります。
よろしくお願いいたします。
```

#### 3. 対面レビュー実施

```
1. 挨拶・概要説明（2分）
   「本日は○○機能のレビューをお願いします」

2. 画面デモ（5分）
   実際に動かして見せる

3. コード説明（10分）
   処理の流れを説明

4. 質疑応答（5分）
   質問に答える、指摘を受ける

5. まとめ（3分）
   指摘事項の確認、次のアクション確認
```

#### 4. 指摘事項の記録

レビュー中はメモを取る：

```markdown
## レビュー記録

日時: 2024/1/15 15:00
レビュアー: 山田さん
対象: ユーザー登録機能

### 指摘事項

1. [必須] UserDAO.java:45行目
   - SQLインジェクション対策が必要
   - PreparedStatementを使用すること

2. [推奨] RegisterServlet.java:30行目
   - バリデーションを追加したほうが良い
   - メールアドレスの形式チェック

3. [軽微] register.jsp:15行目
   - コメントのスペルミス
```

---

## レビュー前に準備する資料

### 1. 機能説明書（簡易版）

```markdown
# ユーザー登録機能

## 概要
新規ユーザーがアカウントを作成できる機能

## 画面イメージ
[スクリーンショットを貼る]

## 機能要件
- ユーザー名、メールアドレス、パスワードを入力
- 入力チェックを行う
- 登録成功後はログイン画面へ遷移

## 処理フロー
1. register.jsp で入力
2. RegisterServlet で受け取り
3. UserDAO.register() でDB登録
4. 成功: login.jsp へリダイレクト
5. 失敗: register.jsp へ戻る（エラー表示）
```

### 2. ファイル一覧

```markdown
## 変更ファイル一覧

| ファイル | 変更内容 | 新規/修正 |
|----------|----------|-----------|
| UserDAO.java | registerメソッド追加 | 修正 |
| RegisterServlet.java | 登録処理 | 新規 |
| register.jsp | 登録フォーム | 新規 |
| style.css | フォームのスタイル追加 | 修正 |
| data.sql | usersテーブル修正 | 修正 |
```

### 3. テスト結果

```markdown
## テスト結果

### 正常系テスト

| No | テスト内容 | 入力値 | 期待結果 | 結果 |
|----|-----------|--------|----------|------|
| 1 | 正常登録 | 田中太郎/tanaka@test.com/pass123 | 登録成功、ログイン画面へ | OK |
| 2 | 全項目入力 | 全て正しい値 | 登録成功 | OK |

### 異常系テスト

| No | テスト内容 | 入力値 | 期待結果 | 結果 |
|----|-----------|--------|----------|------|
| 1 | 空欄送信 | 全て空 | エラー表示 | OK |
| 2 | 重複登録 | 既存のメールアドレス | エラー表示 | OK |
| 3 | 不正メール | abc@@ | エラー表示 | OK |
```

### 4. 画面遷移図

```
[トップページ]
      │
      ↓ 「新規登録」リンク
[登録画面] ←──────┐
      │            │
      ↓ 送信       │ エラー時
[RegisterServlet]──┘
      │
      ↓ 成功時
[ログイン画面]
```

---

## レビュー時の確認事項チェックリスト

### コードの確認

```
□ コンパイルエラーがないか
□ 実行時エラーがないか
□ コーディング規約に従っているか
□ 適切なコメントがあるか
□ 不要なコード（デバッグ用print等）が残っていないか
```

### 機能の確認

```
□ 要件通りに動作するか
□ 正常系のテストをしたか
□ 異常系のテストをしたか
□ 境界値のテストをしたか
□ 画面表示は正しいか
```

### セキュリティの確認

```
□ SQLインジェクション対策（PreparedStatement使用）
□ XSS対策（出力時のエスケープ）
□ パスワードの適切な扱い（平文で保存していないか）
□ セッション管理は適切か
□ 認証チェックは適切か
```

### データベースの確認

```
□ テーブル設計は適切か
□ SQLは正しく動作するか
□ トランザクション処理は適切か
□ コネクションのクローズ漏れはないか
```

---

## 対面レビューのコツ

### 事前準備のコツ

#### コツ1: 動くものを見せる

```
NG: 「まだ動かないんですが...」
OK: 「基本機能は動作します。デモをお見せします」

→ 最低限動く状態でレビューに臨む
→ 動かない部分があれば事前に伝える
```

#### コツ2: 自分でレビューしてから臨む

```
レビュー前の自己チェック:

1. コードを声に出して読む
   → 変な処理に気づきやすい

2. 1日置いてから見直す
   → 新鮮な目で見られる

3. チェックリストで確認
   → 漏れを防ぐ
```

#### コツ3: 説明の練習をする

```
練習方法:
1. 画面を見せながら説明する練習
2. コードの流れを説明する練習
3. 想定質問への回答を準備
```

### レビュー中のコツ

#### コツ4: 素直に聞く

```
NG: 「でも、これでも動きますよね？」（反論）
OK: 「なるほど、そのほうが良いですね」（受け入れ）

→ 指摘は攻撃ではなく、より良くするためのアドバイス
→ まずは受け入れて、疑問があれば質問する
```

#### コツ5: 質問は遠慮なくする

```
OK: 「すみません、○○の意味がわからないのですが...」
OK: 「なぜその方法が良いのでしょうか？」
OK: 「具体的にどう修正すればよいですか？」

→ わからないまま終わらせない
→ 質問することは恥ずかしいことではない
```

#### コツ6: メモを取る

```
必ずメモすること:
- 指摘されたファイル名と行数
- 何が問題か
- どう直すべきか
- 優先度（必須/推奨/軽微）

→ 後で「何を直すんだっけ？」とならないように
```

#### コツ7: 復唱して確認する

```
レビュアー: 「ここはPreparedStatementを使ったほうがいいね」

あなた: 「UserDAO.javaの45行目で、
         文字列結合ではなくPreparedStatementを使う、
         ということですね」

→ 認識のずれを防ぐ
```

### レビュー後のコツ

#### コツ8: すぐに修正に取り掛かる

```
レビュー後のアクション:
1. 指摘事項を整理（優先度順）
2. 必須の指摘から修正
3. 修正したらすぐに再テスト
4. 完了したら報告
```

#### コツ9: 修正報告をする

```
例: 修正完了の報告

○○さん

お疲れ様です。△△です。
先日ご指摘いただいた点を修正しましたので、ご報告します。

■ 修正内容
1. UserDAO.java:45行目
   → PreparedStatementに変更しました

2. RegisterServlet.java:30行目
   → メールアドレスのバリデーションを追加しました

3. register.jsp:15行目
   → コメントのスペルミスを修正しました

再度確認いただけますと幸いです。
よろしくお願いいたします。
```

---

## よくある指摘事項と対策

### Javaコードでよくある指摘

| 指摘内容 | 悪い例 | 良い例 |
|----------|--------|--------|
| 変数名が不明確 | `String s` | `String userName` |
| マジックナンバー | `if (status == 1)` | `if (status == STATUS_ACTIVE)` |
| 例外処理が雑 | `catch (Exception e) {}` | `catch (SQLException e) { e.printStackTrace(); }` |
| リソースの解放漏れ | closeしていない | try-with-resourcesを使用 |
| SQLインジェクション | 文字列結合でSQL作成 | PreparedStatementを使用 |

### JSPでよくある指摘

| 指摘内容 | 悪い例 | 良い例 |
|----------|--------|--------|
| XSS対策漏れ | `${param.name}` | `${fn:escapeXml(param.name)}` |
| スクリプトレット使用 | `<% for(...) %>` | `<c:forEach>` |
| ハードコードURL | `href="/recipe/home"` | `href="${pageContext.request.contextPath}/home"` |

### 設計でよくある指摘

| 指摘内容 | 問題点 | 対策 |
|----------|--------|------|
| 責務の混在 | ServletでSQLを書いている | DAOに分離する |
| 重複コード | 同じ処理が複数箇所にある | 共通メソッドに切り出す |
| 過剰な結合 | 1つ変えると他も壊れる | 依存関係を整理する |

---

## レビュー資料テンプレート

### 簡易レビュー資料（1ページ）

```markdown
# レビュー資料

## 基本情報
- 日付: 2024/1/15
- 作成者: 田中
- 機能名: ユーザー登録機能

## 概要
新規ユーザーがアカウントを作成する機能を実装しました。

## 変更ファイル
1. UserDAO.java - registerメソッド追加
2. RegisterServlet.java - 新規作成
3. register.jsp - 新規作成

## 処理フロー
register.jsp → RegisterServlet → UserDAO → DB

## デモ手順
1. トップページから「新規登録」をクリック
2. 各項目を入力して「登録」ボタンをクリック
3. 成功メッセージが表示されることを確認

## テスト結果
- 正常系: OK
- 異常系（空欄）: OK
- 異常系（重複）: OK

## 質問・相談事項
- パスワードのハッシュ化は次のフェーズで対応予定です
```

---

## 心構え

### レビューを受ける側の心構え

```
1. 指摘 = 人格否定ではない
   → コードへの指摘であり、あなたへの攻撃ではない

2. 完璧を求めすぎない
   → 最初から完璧な人はいない
   → 指摘されて成長する

3. 感謝の気持ちを持つ
   → 時間を割いてレビューしてくれている
   → 「ありがとうございます」を忘れずに

4. 同じ指摘を繰り返さない
   → 指摘されたことはメモして次に活かす
   → 同じミスを繰り返すと信頼を失う
```

### よく使うフレーズ

```
レビュー開始時:
「本日はお時間いただきありがとうございます」
「○○機能のレビューをお願いいたします」

指摘を受けたとき:
「ご指摘ありがとうございます」
「なるほど、そのほうが良いですね」
「確認して修正いたします」

わからないとき:
「すみません、もう少し詳しく教えていただけますか？」
「具体的にはどのように修正すればよいでしょうか？」

レビュー終了時:
「ありがとうございました」
「指摘事項を修正して、再度ご連絡いたします」
```

---

## まとめ

### レビュー成功のポイント

```
事前準備:
✓ 動くものを用意する
✓ 自分でテストしてから臨む
✓ 資料を準備する
✓ 説明の練習をする

レビュー中:
✓ 素直に聞く
✓ メモを取る
✓ 質問する
✓ 復唱して確認する

レビュー後:
✓ すぐに修正する
✓ 修正完了を報告する
✓ 学んだことを次に活かす
```

### 最後に

レビューは**スキルアップの最大のチャンス**です。

指摘されることを恐れず、積極的にフィードバックを求めましょう。
経験豊富な先輩から直接アドバイスをもらえる貴重な機会です。

```
「指摘される」→「直す」→「成長する」

このサイクルを繰り返すことで、
確実にスキルアップできます！
```
